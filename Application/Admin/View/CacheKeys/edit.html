<extend name="Common:base" />
<block name="content">
<div class="row-fluid">
    <div class="portlet box blue">
        <div class="portlet-title">
            <div class="caption"><empty name="info.uid">添加<else/>编辑</empty>缓存规则</div>
        </div>
        <div class="portlet-body form">
            <form id="user_edit" action="{:U('update')}" method="post" class="form-horizontal">
                <div class="control-group">
                    <label class="control-label">Key<span class="required">*</span></label>
                    <div class="controls">
                        <input type="text" name="key" class="m-wrap" value="{$info.key}" placeholder="Key默认使用'jt_'前缀"/>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">缓存描述</label>
                    <div class="controls">
                        <textarea class="span6 m-wrap" rows="3" name="desc">{$info.desc}</textarea>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">Redis存储类型</label>
                    <div class="controls">
                        <select name="redis_type" id="redis_type" class="form-control">
                            <volist id="vo" name="redis_type">
                                <option value="{$vo.id}" <eq name="info.redis_type" value="$vo['id']">selected</eq>>{$vo.title}</option>
                            </volist>
                        </select>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">是否自动更新</label>
                    <div class="controls">
                        <select name="is_auto" id="is_auto" class="form-control">
                            <option value="0" <eq name="info.is_auto" value="0">selected</eq>>否</option>
                            <option value="1" <eq name="info.is_auto" value="1">selected</eq>>是</option>
                        </select>
                    </div>
                </div>

                <!--<div class="control-group">
                    <label class="control-label">数据来源方式</label>
                    <div class="controls">
                        <select name="type" id="type" class="form-control">
                            <option value="1" <eq name="info.type" value="1">selected</eq>>Model</option>
                            <option value="2" <eq name="info.type" value="2">selected</eq>>SQL</option>
                        </select>
                    </div>
                </div>-->
                <input type="hidden" name="type" value="1"/>

                <div class="control-group">
                    <label class="control-label">缓存时间</label>
                    <div class="controls">
                        <input type="text" name="timer" class="m-wrap" value="{$info.timer}" placeholder="不填写默认为永远生效"/>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">Model名称</label>
                    <div class="controls">
                        <input type="text" name="model_name" class="m-wrap" value="{$info.config.model}"/>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">Model方法</label>
                    <div class="controls">
                        <input type="text" name="function" class="m-wrap" value="{$info.config.function}"/>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">Model方法参数</label>
                    <div class="controls">
                        <input type="text" name="param" class="m-wrap" value="{$info.config.param|implode=',',###}" placeholder="多个参数以,分隔"/>
                    </div>
                </div>

                <!--<div class="control-group">
                    <label class="control-label">排序</label>
                    <div class="controls">
                        <input type="text" name="sort" class="m-wrap width-50" value="{$info.sort|default=0}"/>
                    </div>
                </div>-->

                <div class="form-actions">
                    <input type="hidden" name="id" value="{$info.id}"/>
                    <button type="submit" class="btn blue">提交</button>
                    <a class="btn" href="javascript:history.back();">返回</a>
                </div>
            </form>
        </div>
    </div>
</div>
</block>
<block name="js">
    <script type="text/javascript">
        seajs.use(['controller/cache/cacheKeyController'],function(main){
            main.edit();
        });
    </script>
</block>